const ethers = require("ethers")
const solc = require("solc")
const fs = require("fs-extra")
require("dotenv").config()

console.log("Contract Deployment Manual: ")
//INTERACTED WITH 0x01DC26b7CcBD2B007dA34E720aBEaE02B99Be553

// 3Pool transaction const data = https://etherscan.io/tx/0x1cbefbfbddf16ee5e12861442bca0a46c475a2deef48933c4a11d7784f44a437
async function main() {
    const provider = new ethers.getDefaultProvider("http://127.0.0.1:8545")
    // let provider = new ethers.providers.JsonRpcProvider(process.env.RPC_URL)
    let wallet = new ethers.Wallet(process.env.FORK_WALLET_SECRET, provider)

    const abi = fs.readFileSync("./BalancerV2_sol_FlashLoanRecipient.abi", "utf8")
    const binary = fs.readFileSync(
        "./BalancerV2_sol_FlashLoanRecipient.bin",
        "utf8"
    )
    //const contractFactory = new ethers.ContractFactory(abi, binary, wallet)
    //const contract = await contractFactory.deploy();
    //console.log(contract)


    console.log("The Thing: ")
    const nonce = await wallet.getTransactionCount();
    const tx = {
        nonce: nonce,
        gasPrice: 20000000000,
        gasLimit: 6721975,
        to: null,
        value: 0,
        data: "0x60c06040523480156200001157600080fd5b50604051620018fa380380620018fa8339818101604052810190620000379190620001c2565b8073ffffffffffffffffffffffffffffffffffffffff1660a08173ffffffffffffffffffffffffffffffffffffffff168152505060a05173ffffffffffffffffffffffffffffffffffffffff1663d95de76b6040518163ffffffff1660e01b8152600401600060405180830381600087803b158015620000b657600080fd5b505af1158015620000cb573d6000803e3d6000fd5b50505050600060a051604051620000e2906200014a565b620000ee91906200025f565b604051809103906000f0801580156200010b573d6000803e3d6000fd5b5090508073ffffffffffffffffffffffffffffffffffffffff1660808173ffffffffffffffffffffffffffffffffffffffff168152505050506200027c565b610e658062000a9583390190565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006200018a826200015d565b9050919050565b6200019c816200017d565b8114620001a857600080fd5b50565b600081519050620001bc8162000191565b92915050565b600060208284031215620001db57620001da62000158565b5b6000620001eb84828501620001ab565b91505092915050565b6000819050919050565b60006200021f6200021962000213846200015d565b620001f4565b6200015d565b9050919050565b60006200023382620001fe565b9050919050565b6000620002478262000226565b9050919050565b62000259816200023a565b82525050565b60006020820190506200027660008301846200024e565b92915050565b60805160a0516107e5620002b06000396000818161010601526101df0152600081816101b7015261035d01526107e56000f3fe608060405234801561001057600080fd5b50600436106100575760003560e01c80637ceab3b11461005c5780639859387b1461007a5780639dca362f146100aa5780639fde0702146100c8578063a6644516146100e6575b600080fd5b610064610104565b60405161007191906104d2565b60405180910390f35b610094600480360381019061008f9190610530565b610128565b6040516100a1919061056c565b60405180910390f35b6100b26102d2565b6040516100bf919061056c565b60405180910390f35b6100d0610355565b6040516100dd91906105a0565b60405180910390f35b6100ee61035b565b6040516100fb919061056c565b60405180910390f35b7f000000000000000000000000000000000000000000000000000000000000000081565b60008073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610198576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161018f90610618565b60405180910390fd5b600080600081546101a890610667565b919050819055905060006101db7f000000000000000000000000000000000000000000000000000000000000000061037f565b90507f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff1663c55a3cf4858360016040518463ffffffff1660e01b815260040161023b939291906106ca565b600060405180830381600087803b15801561025557600080fd5b505af1158015610269573d6000803e3d6000fd5b50505050818473ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff167f33310a89c32d8cc00057ad6ef6274d2f8fe22389a992cf89983e09fc84f6cfff60405160405180910390a48092505050919050565b60003073ffffffffffffffffffffffffffffffffffffffff16639859387b336040518263ffffffff1660e01b815260040161030d919061056c565b6020604051808303816000875af115801561032c573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103509190610716565b905090565b60005481565b7f000000000000000000000000000000000000000000000000000000000000000081565b60006040517f3d602d80600a3d3981f3363d3d373d3d3d363d7300000000000000000000000081528260601b60148201527f5af43d82803e903d91602b57fd5bf3000000000000000000000000000000000060288201526037816000f0915050600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff160361044e576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016104459061078f565b60405180910390fd5b919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b600061049861049361048e84610453565b610473565b610453565b9050919050565b60006104aa8261047d565b9050919050565b60006104bc8261049f565b9050919050565b6104cc816104b1565b82525050565b60006020820190506104e760008301846104c3565b92915050565b600080fd5b60006104fd82610453565b9050919050565b61050d816104f2565b811461051857600080fd5b50565b60008135905061052a81610504565b92915050565b600060208284031215610546576105456104ed565b5b60006105548482850161051b565b91505092915050565b610566816104f2565b82525050565b6000602082019050610581600083018461055d565b92915050565b6000819050919050565b61059a81610587565b82525050565b60006020820190506105b56000830184610591565b92915050565b600082825260208201905092915050565b7f6163636f756e742d666163746f72792f7a65726f2d6164647265737300000000600082015250565b6000610602601c836105bb565b915061060d826105cc565b602082019050919050565b60006020820190508181036000830152610631816105f5565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600061067282610587565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82036106a4576106a3610638565b5b600182019050919050565b60008115159050919050565b6106c4816106af565b82525050565b60006060820190506106df600083018661055d565b6106ec602083018561055d565b6106f960408301846106bb565b949350505050565b60008151905061071081610504565b92915050565b60006020828403121561072c5761072b6104ed565b5b600061073a84828501610701565b91505092915050565b7f455243313136373a20637265617465206661696c656400000000000000000000600082015250565b60006107796016836105bb565b915061078482610743565b602082019050919050565b600060208201905081810360008301526107a88161076c565b905091905056fea2646970667358221220865f6918baad52ee4688a31a4730cbfdce21b0bb4501ecb5dcec3494b71e058964736f6c6343000811003360a06040523480156200001157600080fd5b5060405162000e6538038062000e65833981810160405281019062000037919062000162565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603620000a9576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401620000a0906200021b565b60405180910390fd5b8073ffffffffffffffffffffffffffffffffffffffff1660808173ffffffffffffffffffffffffffffffffffffffff1681525050506200023d565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006200011682620000e9565b9050919050565b60006200012a8262000109565b9050919050565b6200013c816200011d565b81146200014857600080fd5b50565b6000815190506200015c8162000131565b92915050565b6000602082840312156200017b576200017a620000e4565b5b60006200018b848285016200014b565b91505092915050565b600082825260208201905092915050565b7f6163636f756e742d67756172642f77726f6e672d67756172642d61646472657360008201527f7300000000000000000000000000000000000000000000000000000000000000602082015250565b60006200020360218362000194565b91506200021082620001a5565b604082019050919050565b600060208201905081810360008301526200023681620001f4565b9050919050565b608051610bf76200026e6000396000818161013401528181610281015281816102a7015261034c0152610bf76000f3fe6080604052600436106100435760003560e01c80631cff79cd146100885780637ceab3b1146100b85780638da5cb5b146100e3578063c89acc861461010e57610083565b36610083577f4c2ffa71705c7e25830709a453da0f6066957bd706c2b7f1b7fc66d3805e92f73334604051610079929190610581565b60405180910390a1005b600080fd5b6100a2600480360381019061009d9190610730565b61012a565b6040516100af91906107a5565b60405180910390f35b3480156100c457600080fd5b506100cd61027f565b6040516100da919061081f565b60405180910390f35b3480156100ef57600080fd5b506100f86102a3565b604051610105919061083a565b60405180910390f35b610128600480360381019061012391906108b5565b610344565b005b60008260016000807f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff1663f526d1ee303387876040518563ffffffff1660e01b81526004016101919493929190610930565b6040805180830381865afa1580156101ad573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101d191906109a1565b9150915081610215576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161020c90610a3e565b60405180910390fd5b80610255576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161024c90610aaa565b60405180910390fd5b602060008751602089018a6113885a03f43d6000803e806000811461027a5760206000f35b3d6000fd5b7f000000000000000000000000000000000000000000000000000000000000000081565b60007f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff1663022914a7306040518263ffffffff1660e01b81526004016102fe919061083a565b602060405180830381865afa15801561031b573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061033f9190610adf565b905090565b8260008060007f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff1663f526d1ee303387876040518563ffffffff1660e01b81526004016103a99493929190610930565b6040805180830381865afa1580156103c5573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103e991906109a1565b915091508161042d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161042490610a3e565b60405180910390fd5b8061046d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161046490610aaa565b60405180910390fd5b60008773ffffffffffffffffffffffffffffffffffffffff16348888604051610497929190610b3c565b60006040518083038185875af1925050503d80600081146104d4576040519150601f19603f3d011682016040523d82523d6000602084013e6104d9565b606091505b505090508061051d576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161051490610ba1565b60405180910390fd5b5050505050505050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061055282610527565b9050919050565b61056281610547565b82525050565b6000819050919050565b61057b81610568565b82525050565b60006040820190506105966000830185610559565b6105a36020830184610572565b9392505050565b6000604051905090565b600080fd5b600080fd5b6105c781610547565b81146105d257600080fd5b50565b6000813590506105e4816105be565b92915050565b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b61063d826105f4565b810181811067ffffffffffffffff8211171561065c5761065b610605565b5b80604052505050565b600061066f6105aa565b905061067b8282610634565b919050565b600067ffffffffffffffff82111561069b5761069a610605565b5b6106a4826105f4565b9050602081019050919050565b82818337600083830152505050565b60006106d36106ce84610680565b610665565b9050828152602081018484840111156106ef576106ee6105ef565b5b6106fa8482856106b1565b509392505050565b600082601f830112610717576107166105ea565b5b81356107278482602086016106c0565b91505092915050565b60008060408385031215610747576107466105b4565b5b6000610755858286016105d5565b925050602083013567ffffffffffffffff811115610776576107756105b9565b5b61078285828601610702565b9150509250929050565b6000819050919050565b61079f8161078c565b82525050565b60006020820190506107ba6000830184610796565b92915050565b6000819050919050565b60006107e56107e06107db84610527565b6107c0565b610527565b9050919050565b60006107f7826107ca565b9050919050565b6000610809826107ec565b9050919050565b610819816107fe565b82525050565b60006020820190506108346000830184610810565b92915050565b600060208201905061084f6000830184610559565b92915050565b600080fd5b600080fd5b60008083601f840112610875576108746105ea565b5b8235905067ffffffffffffffff81111561089257610891610855565b5b6020830191508360018202830111156108ae576108ad61085a565b5b9250929050565b6000806000604084860312156108ce576108cd6105b4565b5b60006108dc868287016105d5565b935050602084013567ffffffffffffffff8111156108fd576108fc6105b9565b5b6109098682870161085f565b92509250509250925092565b60008115159050919050565b61092a81610915565b82525050565b60006080820190506109456000830187610559565b6109526020830186610559565b61095f6040830185610559565b61096c6060830184610921565b95945050505050565b61097e81610915565b811461098957600080fd5b50565b60008151905061099b81610975565b92915050565b600080604083850312156109b8576109b76105b4565b5b60006109c68582860161098c565b92505060206109d78582860161098c565b9150509250929050565b600082825260208201905092915050565b7f6163636f756e742d67756172642f6e6f2d7065726d6974000000000000000000600082015250565b6000610a286017836109e1565b9150610a33826109f2565b602082019050919050565b60006020820190508181036000830152610a5781610a1b565b9050919050565b7f6163636f756e742d67756172642f696c6c6567616c2d74617267657400000000600082015250565b6000610a94601c836109e1565b9150610a9f82610a5e565b602082019050919050565b60006020820190508181036000830152610ac381610a87565b9050919050565b600081519050610ad9816105be565b92915050565b600060208284031215610af557610af46105b4565b5b6000610b0384828501610aca565b91505092915050565b600081905092915050565b6000610b238385610b0c565b9350610b308385846106b1565b82840190509392505050565b6000610b49828486610b17565b91508190509392505050565b7f6163636f756e742d67756172642f63616c6c2d6661696c656400000000000000600082015250565b6000610b8b6019836109e1565b9150610b9682610b55565b602082019050919050565b60006020820190508181036000830152610bba81610b7e565b905091905056fea26469706673582212201d1698a8a0d1b995e507b6bb1aafdd8737d0b93524f1ac7a9898737e8dc03f0664736f6c63430008110033000000000000000000000000ce91349d2a4577bbd0fc91fe6019600e047f2847",
        chainId: provider.chainId,
    };
    
    //const signedTxResponse = await wallet.signTransaction(tx);
    //console.log(signedTxResponse);
    const sentTxResponse = await wallet.sendTransaction(tx);
    await sentTxResponse.wait(1);
    console.log(sentTxResponse)

}

main()